---
title: "Lab Assignment 1"
author: "Joakim Olofsson, Jesper Nyman, Oliver Pahmp, Roma Goussakov"
date: "18 Sep 2019"
output:
  pdf_document:
    keep_md: no
---

***
## Task 1
***

>Task 1.1:

<!-- This will install the package and look up 'rmvnorm' function. (HTML comment) -->
```{r}
install.packages("mixtools")
library(mixtools)
?rmvnorm
```

<!-- Time to generate 1000 realizations from a 2D Gaussian distrubution -->
```{r}
n = 1000 # number of realizations
p = 0.7 # correlation factor
mu = c(2,3) # mean
sigma = c(1,4) # sigma
Cov = matrix(c(1, p*2, p*2, 4),nrow=2,ncol=2) # Covariance

set.seed(5)
X = rmvnorm(n, mu, Cov) # X values

plot(X) # Scatterplot
```

>Task 1.2:

```{r echo=False}
set.seed(5)
latent_variable <- c(rbinom(1000, 1, 0.6))
simulation_1.2 <- matrix(0, nrow = 1000, ncol = 2)

for(i in 1:length(latent_variable)){
  if(latent_variable[i] == 1){
    simulation_1.2[i,] <- rmvnorm(1, mu=c(2,3), sigma=matrix(c(0.04, 0.06, 0.06, 0.36), nrow = 2, ncol = 2))
  } else if(latent_variable[i] == 0){
    simulation_1.2[i,] <- rmvnorm(1, mu=c(3,2), sigma=matrix(c(0.16, 0.06, 0.06, 0.09), nrow = 2, ncol = 2))
  }
}

```

>Task 1.3:

```{r}
lambda = c(0.6, 0.4)
set.seed(5)
Y = mvnormalmixEM(X, c(0.6,0.4))
res1 = Y$mu[[1]] - u1 # Compare difference between means
res2 = Y$mu[[2]] - u2 # Compare diff between means

# There seems to be smaller than 5% difference in means.
```

***
## Task 2
***


```{r}
iris_data <- read.table(file.choose(), header = TRUE)
set.seed(5)
puzzle_estimate <- mvnormalmixEM(iris_data, k=2)
puzzle_estimate[3]
```
From our reaserch we could conclude that the means correspond to setosa and verticolor!!!

